"0","# Add a column to original stops dataset identifying a driver as white or a minority"
"0","stops$ethnicity <- ifelse(((stops$SubjectRaceCode ==  ""W"") & (stops$SubjectEthnicityCode ==""N"")), ""White"", ""Minority"")"
"0","# Create a dataframe of only minority stops"
"0","coords <- subset(stops, ethnicity==""Minority"")"
"0","coords <- coords[c(""InterventionLocationLongitude"", ""InterventionLocationLatitude"")]"
"0","coords <- coords[complete.cases(coords),]"
"0","sp <- SpatialPoints(coords)"
"0","proj4string(sp) <- ""+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"""
"0","proj4string(sp)"
"1","[1]"
"1"," ""+proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0"""
"1","
"
"0","# Points in a polygon for minorities who were stopped"
"0","m_tract <- over(sp, towntracts_only)"
"0","m_tract <- m_tract %>%"
"0","  group_by(GEOID10) %>%"
"0","  summarise(minority=n())"
"0","m_tract <- m_tract[!is.na(m_tract$GEOID10),]"
"0","colnames(m_tract) <- c(""id"", ""minority"")"
"0","m_tract$id <- as.character(m_tract$id)"
"0","joined_tracts <- left_join(by_tract, m_tract)"
"2","Joining, by = ""id""
"
"0","# Calculating percent of stops that were minorities"
"0","joined_tracts$minority_p <- round(joined_tracts$minority/joined_tracts$total*100,2)"
